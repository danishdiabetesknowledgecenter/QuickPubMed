# Apache .htaccess fil til PHP Proxy
# SÃ¸rger for at requests til /api/* routes til de rigtige PHP filer

RewriteEngine On

# CORS headers for all requests
<IfModule mod_headers.c>
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>

# Handle OPTIONS preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Beskyt config.php mod direkte adgang
<Files "config.php">
    Order Allow,Deny
    Deny from all
</Files>

# Route OpenAI API requests
RewriteRule ^api/SummarizeSearch$ api/SummarizeSearch.php [L,QSA]
RewriteRule ^api/TranslateTitle$ api/TranslateTitle.php [L,QSA]
RewriteRule ^api/SummarizeHTMLArticle$ api/SummarizeHTMLArticle.php [L,QSA]
RewriteRule ^api/SummarizePDFArticle$ api/SummarizePDFArticle.php [L,QSA]
RewriteRule ^api/CheckIfResourceIsForbidden$ api/CheckIfResourceIsForbidden.php [L,QSA]

# Route NLM/PubMed API requests
RewriteRule ^api/nlm/esearch$ api/NlmSearch.php [L,QSA]
RewriteRule ^api/nlm/esummary$ api/NlmSummary.php [L,QSA]
RewriteRule ^api/nlm/efetch$ api/NlmFetch.php [L,QSA]

# Disable caching for API responses
<IfModule mod_headers.c>
    <FilesMatch "\.(php)$">
        Header set Cache-Control "no-cache, no-store, must-revalidate"
        Header set Pragma "no-cache"
        Header set Expires 0
    </FilesMatch>
</IfModule>

